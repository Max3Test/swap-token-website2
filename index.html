<!-- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –≤–∏–∑—É–∞–ª–æ–º + –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Web3Modal –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫ -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>StMAX Farm + Bridge</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  <script src="https://unpkg.com/web3modal"></script>
  <script src="https://unpkg.com/@axelar-network/axelarjs-sdk/dist/index.umd.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(to right, #1c1c1c, #2c2c2c);
      color: white;
      margin: 0;
      padding: 0;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      padding: 20px;
    }
    .left-panel, .right-panel {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .container {
      background: rgba(0,0,0,0.7);
      margin: auto;
      margin-top: 40px;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 0 20px #00ffff88;
      max-width: 400px;
      text-align: center;
    }
    select, input[type="number"], button {
      width: 100%;
      padding: 12px;
      margin-bottom: 12px;
      border-radius: 10px;
      border: none;
      font-size: 16px;
    }
    button {
      background: linear-gradient(to right, #00ffff, #007bff);
      color: #fff;
      cursor: pointer;
    }
    button:hover {
      background: linear-gradient(to right, #007bff, #00ffff);
    }
    .title {
      text-align: center;
      font-size: 2em;
      color: #00ffff;
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <div class="left-panel">
      <button onclick="showTab('stake')">Stake</button>
      <button onclick="showTab('unstake')">Unstake</button>
    </div>
    <div class="right-panel">
      <button onclick="connectWallet()">Connect Wallet</button>
    </div>
  </div>

  <div class="title">Cross Chain Meme Proof Of Farm</div>

  <div class="container">
    <h2 id="tabTitle">Stake MAX ‚Üí StMAX</h2>
    <input type="number" id="stakeAmount" placeholder="Amount to Stake" />
    <button onclick="stakeTokens()">Stake</button>

    <div id="unstakeSection" style="display:none;">
      <h2>Unstake StMAX ‚Üí MAX</h2>
      <input type="number" id="unstakeAmount" placeholder="Amount to Unstake" />
      <button onclick="unstakeTokens()">Unstake</button>
    </div>

    <hr>
    <h3>Axelar Bridge</h3>
    <select id="fromChain">
      <option value="base">BASE</option>
      <option value="arbitrum">ARB</option>
      <option value="optimism">OP</option>
      <option value="binance">BNB</option>
      <option value="ethereum">ETH</option>
    </select>
    <select id="toChain">
      <option value="base">BASE</option>
      <option value="arbitrum">ARB</option>
      <option value="optimism">OP</option>
      <option value="binance">BNB</option>
      <option value="ethereum">ETH</option>
    </select>
    <select id="bridgeTokenSymbol">
      <option value="MAX">MAX</option>
      <option value="StMAX">StMAX</option>
    </select>
    <input type="number" id="bridgeAmount" placeholder="Amount to bridge" />
    <button onclick="bridgeWithAxelarUI()">Bridge with Axelar</button>
  </div>

<script>
let provider;
let signer;

function showTab(tab) {
  document.getElementById("unstakeSection").style.display = (tab === 'unstake') ? 'block' : 'none';
  document.getElementById("tabTitle").innerText = (tab === 'unstake') ? "Unstake StMAX ‚Üí MAX" : "Stake MAX ‚Üí StMAX";
}

async function connectWallet() {
  const web3Modal = new window.Web3Modal({ cacheProvider: false });
  const instance = await web3Modal.connect();
  provider = new ethers.providers.Web3Provider(instance);
  signer = provider.getSigner();
  const address = await signer.getAddress();
  console.log("üîó Connected:", address);
}

async function stakeTokens() {
  if (!signer) return alert("Connect wallet first");
  const amount = document.getElementById("stakeAmount").value;
  const tokenAddress = "0x...";
  const wrapperAddress = "0x...";
  const tokenABI = ["function approve(address,uint256) external returns (bool)"];
  const wrapperABI = ["function deposit(uint256) external"];
  const token = new ethers.Contract(tokenAddress, tokenABI, signer);
  const wrapper = new ethers.Contract(wrapperAddress, wrapperABI, signer);
  const value = ethers.utils.parseUnits(amount, 18);
  await token.approve(wrapperAddress, value);
  await wrapper.deposit(value);
  alert("‚úÖ Staked!");
}

async function unstakeTokens() {
  if (!signer) return alert("Connect wallet first");
  const amount = document.getElementById("unstakeAmount").value;
  const wrapperAddress = "0x...";
  const wrapperABI = ["function withdraw(uint256) external"];
  const wrapper = new ethers.Contract(wrapperAddress, wrapperABI, signer);
  const value = ethers.utils.parseUnits(amount, 18);
  await wrapper.withdraw(value);
  alert("‚úÖ Unstaked!");
}

function bridgeWithAxelarUI() {
  const from = document.getElementById("fromChain").value;
  const to = document.getElementById("toChain").value;
  const symbol = document.getElementById("bridgeTokenSymbol").value;
  const amt = document.getElementById("bridgeAmount").value;
  if (!from || !to || !symbol || !amt) return alert("Please fill all fields");
  bridgeWithAxelar(from, to, symbol, amt);
}

window.bridgeWithAxelar = async function (sourceChain, destChain, tokenSymbol, amount) {
  try {
    const environment = "mainnet";
    const axelar = new window.axelar.AxelarGMPRecoveryAPI({ environment });
    if (!window.ethereum) return alert("No wallet");
    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
    const userAddress = accounts[0];
    const provider = new ethers.providers.Web3Provider(window.ethereum);
    const signer = provider.getSigner();
    const axelarGatewayAddress = "0x4cF4F9cD7f541E2070743b59D0aD016F28E9dC16";
    const tokenAddress = "0x...";
    const tokenABI = ["function approve(address,uint256) external returns (bool)", "function allowance(address,address) view returns (uint256)"];
    const gatewayABI = ["function sendToken(string,string,string,uint256) external"];
    const token = new ethers.Contract(tokenAddress, tokenABI, signer);
    const gateway = new ethers.Contract(axelarGatewayAddress, gatewayABI, signer);
    const value = ethers.utils.parseUnits(amount, 18);
    const allowance = await token.allowance(userAddress, axelarGatewayAddress);
    if (allowance.lt(value)) await (await token.approve(axelarGatewayAddress, value)).wait();
    await (await gateway.sendToken(destChain, userAddress, tokenSymbol, value)).wait();
    alert(`‚úÖ Sent ${amount} ${tokenSymbol} to ${destChain}`);
  } catch (err) {
    console.error(err);
    alert("‚ùå Bridge failed");
  }
}
</script>
</body>
</html>

